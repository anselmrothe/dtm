                                 Consistent Probabilistic Simulation Underlying
                                      Human Judgment in Substance Dynamics
                         James Kubricht?1                   Yixin Zhu?2                     Chenfanfu Jiang?3
                         kubricht@ucla.edu              yixin.zhu@ucla.edu                 cffjiang@cs.ucla.edu
                      Demetri Terzopoulos3               Song-Chun Zhu2,3                     Hongjing Lu1,2
                           dt@cs.ucla.edu               sczhu@stat.ucla.edu                hongjing@ucla.edu
                   1 Department of Psychology        2 Department of Statistics    3 Department of Computer Science
                                       ? Equal Contributors    University of California, Los Angeles
                               Abstract                                    Bates et al. (2015) extended the noisy Newton framework
   A growing body of evidence supports the hypothesis that hu-          from block tower judgments (Battaglia et al., 2013) to liq-
   mans infer future states of perceived physical situations by         uid dynamics using an intuitive fluid engine (IFE). In their
   propagating noisy representations forward in time using ratio-       IFE, ground-truth physics was approximated using smoothed
   nal (approximate) physics. In the present study, we examine
   whether humans are able to predict (1) the resting geometry          particle hydrodynamics (SPH (Monaghan, 1992), a particle-
   of sand pouring from a funnel and (2) the dynamics of three          based computational method for simulating non-solid dy-
   substances—liquid, sand, and rigid balls—flowing past obsta-         namics. Their model predictions matched human judgments
   cles into two basins. Participants’ judgments in each experi-        about future fluid states and outperformed alternative mod-
   ment are consistent with simulation results from the intuitive
   substance engine (ISE) model, which employs a Material Point         els that did not employ probabilistic simulation or account
   Method (MPM) simulator with noisy inputs. The ISE outper-            for physical uncertainty. Furthermore, the authors found that
   forms ground-truth physical models in each situation, as well        their participants’ predictions were sensitive to latent fluid
   as two data-driven models. The results reported herein expand        attributes (stickiness and viscosity), suggesting that humans
   on previous work proposing human use of mental simulation in
   physical reasoning and demonstrate human proficiency in pre-         have rich knowledge about the intrinsic properties of liquid.
   dicting the dynamics of sand, a substance that is less common           The present study argues for the same general class of
   in daily life than liquid or rigid objects.                          model as Bates et al.’s (2015) IFE and extends their work
   Keywords: Intuitive physics; mental simulation; substance            by examining (1) whether human predictions about future
   representation; prediction                                           states of multiple substances (i.e., rigid balls, liquid, and
                            Introduction                                sand) differ, and (2) whether those differences can be consis-
                                                                        tently modeled using approximate, probabilistic simulation
Consider KerPlunk, a children’s game in which marbles are               based on a hybrid particle/grid simulator adapted from previ-
suspended in the air by a lattice of straws within a cylindrical        ous work (Kubricht et al., 2016). Although granular materials
tube. The goal of the game is for each player to take turns re-         (e.g., sand) are encountered in everyday life, they are far less
moving straws while minimizing the number of marbles that               common than liquid; can humans accurately predict how sand
fall through the lattice. The task requires players to reason           will interact with obstacles and support surfaces? We present
about the interaction between rigid bodies and obstacles in             two experiments exploring the human capacity to predict the
3D space. But what if the marbles were replaced by balls of             dynamics of substances varying in familiarity and physical
liquid or sand? Could humans predict how those substances               properties, examining how human judgments and model pre-
would move? Would those predictions agree with a genera-                dictions vary for different substances. Experiment 1 examines
tive model based on ground-truth, Newtonian physics?                    human predictions about the resting composition of sand af-
   Recent computational evidence has demonstrated that hu-              ter pouring from a funnel. In Experiment 2, participants make
man predictions do agree with Newtonian physics, given                  predictions about the flow of liquid, sand, and rigid balls past
noisy perception and prior beliefs about spatially represented          obstacles using a design similar to Bates et al.’s (2015) study.
variables: i.e., the noisy Newton hypothesis (Bates, Yildirim,
Tenenbaum, & Battaglia, 2015; Battaglia, Hamrick, & Tenen-                               Computational Models
baum, 2013; Gerstenberg, Goodman, Lagnado, & Tenen-
baum, 2015; Hamrick, Battaglia, Griffiths, & Tenenbaum,                 MPM Physical Simulator
2016; Kubricht et al., 2016; Sanborn, 2014; Sanborn, Mans-              The Material Point Method (MPM) (Sulsky, Zhou, &
inghka, & Griffiths, 2013; K. Smith, Battaglia, & Vul, 2013).           Schreyer, 1995) is commonly used in computer graphics to
The hypothesis suggests that humans rationally infer the val-           simulate the behavior of solids and fluids. The MPM has pro-
ues of physical variables and utilize normative conservation            duced physically accurate and visually realistic simulations
principles (approximately) to make predictions about future             of the dynamics of liquid (Jiang, Schroeder, Selle, Teran, &
scene states. Computationally, this is achieved by sampling             Stomakhin, 2015) and sand (Klár et al., 2016), in addition
the initial locations, motions from noisy sensory input, and            to general continuum materials such as stiff elastic objects
sampling physical attributes in a physical scene, propagating           (Jiang, Schroeder, Teran, Stomakhin, & Selle, 2016).
these variables forward in time according to approximated                  The Appendix presents a mathematical overview of our
physical principles, and aggregating queries on the final scene         MPM simulator, which provides a unified, particle-based
states to form predicted response distributions.                        simulation framework that handles rigid balls, liquid, and
                                                                    700

sand with essentially the same numerical algorithm, albeit
with appropriately differing material parameters. The MPM
method is physically accurate, numerically stable, and com-
putationally efficient, enabling us to synthesize a large set of
stimuli in a short amount of time by simply varying material
parameters and the locations of the initial objects and col-
liding geometries. Running all the simulations in the same
framework for the purposes of the present study also enables
fair comparisons among the three types of substances, since
we avoid potential inconsistencies in the numerical accura-
cies of multiple simulators specialized to particular materials.
Intuitive Substance Engine
Although the MPM simulator provides accurate and stable
kinematics and dynamics for liquid, sand, and rigid balls us-
ing a unified framework, this high-precision, deterministic
process does not account for the variability of human judg-             Figure 1: Intermediate frames from the demonstration video
ments in various intuitive physics tasks. Inspired by previous          in Experiment 1 from the (A) zoomed-out and (B) zoomed-in
implementations of the noisy Newton framework (e.g., Bates              perspective. (C) Sand pile choices in Experiment 1’s judg-
et al., 2015; Battaglia et al., 2013), we combined our MPM              ment task.
simulator with noisy inputs, yielding an Intuitive Substance                                   Experiment 1
Engine (ISE) that accounts for uncertainty in human percep-
tion and reasoning in physical situations involving the three           The first experiment was designed to determine whether hu-
substances examined in this study. Details on how noisy per-            mans are able to predict the resting geometry of sand after it
ceptual inputs are defined and sampled are provided in the              is poured from a funnel onto a surface, and whether dynamic
Model Results section of each experiment.                               visualizations of the pouring behavior facilitate mental simu-
                                                                        lation of sand-surface interactions.
   It is important to note that our ISE (employing MPM simu-
lation) is roughly equivalent to Bates et al.’s (2015) IFE (em-         Participants
ploying SPH simulation) in that both models apply the noisy
                                                                        A total of 108 undergraduate students (81 females), of mean
Newton framework to substance dynamics. Indeed, SPH is a
                                                                        age = 20.2 years, were recruited from the University of Cali-
viable method for simulating the dynamics of both granular
                                                                        fornia, Los Angeles (UCLA), Department of Psychology sub-
materials and liquids, although MPM provides a more effi-
                                                                        ject pool and were compensated with course credit.
cient and accurate means of doing so. We do not envision
that the predictions of the two methods would differ substan-           Materials and Procedure
tially from one another when applied to a given set of stimuli.         Participants first viewed a demonstration video of sand falling
                                                                        from a funnel suspended 10 cm above a level surface. The
Data-Driven Models
                                                                        pouring event was viewed three times from a zoomed-out
Two data-driven models based on statistical learning meth-              perspective (Fig. 1A) and then a zoomed-in perspective
ods were constructed as competing models—the generalized                (Fig. 1B). The duration of the video was 29 sec. After view-
linear model (GLM) (McCullagh, 1984) and Extreme Gradi-                 ing the demonstration video, participants were presented with
ent Boosting (XGBoost) (Chen & Guestrin, 2016). GLM is                  a sand-filled funnel suspended 1/2, 1, 2, and 4 cm above the
a classic machine learning method, commonly expressed by                surface in a randomized order.
Y = XB + U, where X is the feature input matrix, B is the pa-              Forty-three participants were assigned to the Static Con-
rameter matrix (learned using a training dataset), and U is the         dition and viewed a static image (zoomed-out) in which
error between the ground truth matrix Y and prediction XB.              the funnel was positioned at a particular height. Sixty-five
   XGBoost is a recently-published machine learning method              were assigned to the Dynamic Condition and viewed a video
which has been utilized by multiple research teams to achieve           (zoomed in and out; looped three times; 35 sec duration) of
outstanding performance in several Kaggle competitions. Es-             sand pouring from a funnel that was positioned at different
sentially, it is a type of tree ensemble model: i.e., a set of          heights above the surface. In the Dynamic Condition, the re-
classification and regression trees (CART). Formally, ŷi =             gion of the surface where the sand fell was occluded by a gray
∑Kk=1 fk (xi ), where K is the number of trees, fk is a func-           rectangle.
tion in the functional space F comprising the set of all pos-              After viewing each situation, participants were asked to in-
sible CARTS. The objective function is defined as R(θ) =                dicate which of four sand piles would result from the sand
∑ni=1 l(yi , ŷi ) + ∑Kk=1 Ω( fk ), where θ includes the model pa-      pouring from the funnel at the indicated height (Fig. 1C).
rameters to be learned during training, l is the loss function,         For each trial, the stimulus images (for the Static Condition)
which measures the cost between ground truth yi and predic-             and final video frames (Dynamic Condition) remained on the
tion ŷi , and ∑Kk=1 Ω( fk ) is a regularization term that prevents     screen until a response was made. The pile choices were
the model from over-fitting the training data.                          shown from the zoomed-in perspective and represented the
                                                                    701

                                                                           sand pile for each sample. Instead of choosing from 4 piles
               1
                                                                           (i.e., the task presented to the participants), the MPM simula-
              0.8                                                          tor compares the estimated height of the final sand pile, for-
                                                                           mally D(Hi , θi ) = H p ∈ R > 0, with the heights of the 4 pile
Probability
              0.6
                                                                           options given to human participants. The pile option with
              0.4                                                          the minimum height difference was chosen as the predicted
              0.2
                                                                           judgment for each sample. Finally, by aggregating predic-
                                                                           tions across the 10, 000 samples, our ISE outputs a predicted
               0                                                           response distribution for each trial.
                    Human   ISE        XGBoost          GLM
                                                                              To model physical uncertainty in participants’ mental sim-
               1                                                           ulations, our ISE sampled funnel heights and friction angles
              0.8                                                          from noisy distributions. Gaussian noise (0 mean, σ2H vari-
                                                                           ance) was added to the ground-truth funnel height in each
Probability
              0.6
                                                                           situation. Gaussian noise was also added to the ground-truth
              0.4                                                          friction angle θiT , but in logarithmic space (see Sanborn et al.,
              0.2
                                                                           2013): θi = f −1 ( f (θiT ) + ε), where θiT is the ground truth
                                                                           value of the initial sand height, f (θiT ) = log(ω · θiT + k), and
               0                                                           ε represents Gaussian noise with 0 mean and σ2ε variance. The
                    Human   ISE        XGBoost          GLM
                                                                           results reported herein used the following model parameters:
Figure 2: Model prediction results compared to human judg-                 σH = 0.12HiT , σε = 0.6, ω = 0.8 and k = 1.5.
ments. (Upper) Static Condition. (Lower) Dynamic Condi-                    Data-Driven Predictions: To predict human judgments,
tion. Each bar, 1, 2, 3, and 4, corresponds to testing trials              both GLM and XGBoost were tested on the ith pile (i =
with funnel height 1/2, 1, 2, and 4 cm, respectively.                      1, 2, 3, 4) and trained on the remaining three piles. During
ground-truth resting geometries resulting from each situation:             training, 10, 000 samples were drawn for each remaining pile
i.e., Piles 1, 2, 3, and 4 correspond with the pile resulting from         (30, 000 samples) and passed to our MPM simulator. Sam-
funnels suspended 1/2, 1, 2, and 4 cm above the surface, re-               ples were generated using the sampling method described in
spectively. The experiment consisted of 4 trials. The stimulus             the previous section. After training on the 30, 000 samples,
videos can be viewed at https://vimeo.com/216585992.                       both data-driven models were tested on another 10, 000 sam-
                                                                           ples generated from noisy input based on the configuration of
Human Results                                                              pile i. The final distribution was formed by aggregating the
At each funnel height, the proportion of participants choos-               predictions across the 10, 000 samples.
ing each sand pile did not differ between the Dynamic and                  Table 1: Root-mean-square deviation (RMSD) values for the
Static Conditions: χ2 (3) = 2.21, 2.34, 2.41, and 1.13 for fun-            ground-truth (GT), ISE, GLM, and XGBoost models for Ex-
nel heights of 1/2, 1, 2, and 4 cm, respectively. These results            periments 1 and 2. Lower values of RMSD indicate better
suggest that dynamic visualizations of sand pouring from                   model fits.
the funnel in each situation did not alter participants’ judg-
                                                                                                         GT      ISE     XGBoost     GLM
ments about the sand’s resting geometry. However, the par-
                                                                             Experiment 1 (Static)      0.458   0.101     0.267      0.171
ticipants’ pile choices did vary across different heights (χ2 (9)            Experiment 1 (Dynamic)     0.445   0.104     0.237      0.148
= 176.54), indicating that funnel height influenced their pre-               Experiment 2 (Liquid)      0.145   0.081     1.382      0.077
dictions on the resting geometry of falling sand.                            Experiment 2 (Sand)        0.170   0.080     1.422      0.120
   As shown in Fig. 2, participants’ pile choices shifted                    Experiment 2 (Balls)       0.186   0.102     2.067      0.191
toward higher-numbered, flatter piles as funnel height in-
creased. These results indicate that participants’ predictions             Model Comparisons: Fig. 2 depicts the predictions of the
were sensitive to funnel height, but inconsistent with ground-             ISE, XGBoost, and GLM models compared to human judg-
truth resting states. In the next section, predictions from the            ments. All four models achieved high correlations with hu-
three computational models (ISE, GLM, and XGBoost) are                     man performance (Static: r(12) = 0.91, 0.84, and 0.27; Dy-
compared to human performance to determine whether the                     namic: r(12) = 0.88, 0.88, and 0.30 for ISE, XGBoost, and
noisy Newton framework can account for participants’ devi-                 GLM, respectively). Human performance was much less cor-
ations from ground-truth judgments.                                        related with ground-truth predictions (Static: r(12) = 0.17;
                                                                           Dynamic: r(12) = 0.19). The ISE model predictions were
Model Results                                                              more correlated with the human data than the competing data-
ISE Predictions: The input variables for our ISE in Exper-                 driven model predictions in the Static condition but were
iment 1 were funnel height (i.e., initial sand height) with per-           only slightly more correlated than XGBoost predictions in
ceptual uncertainty and sand friction angle with mental sim-               the Dynamic condition. Hence, this paper uses The root-
ulation uncertainty. Given the ground-truth values of initial              mean-square deviation (RMSD) between human responses
funnel height and friction angle (HiT , θiT ), N = 10, 000 noisy           and model results to compare the model fits. We found that
samples {(Hi , θi ), i = 1, ..., N} were generated and passed              RMSD between human responses and ISE predictions for the
to our MPM simulator, which returned the final height of the               4 judgment trials was less than that between ground-truth pre-
                                                                     702

dictions in both Static and Dynamic Conditions (see Table 1).
We also examined modeling performance using the Bayesian
information criterion (BIC) to account for the different num-
ber of free parameters in each model. We found that the
ISE provides a better fit to the human data than the ground-
truth and data-driven models in both conditions. For ground-
truth, ISE, XGBoost, and GLM models, Static BIC = −25.0,
−62.3, −31.2, −45.4, and Dynamic BIC = −25.9, −61.3,
−35.0, −50.0, respectively. The model with the lowest BIC
value is preferred.
   Although XGBoost captures most of the trends in the hu-              Figure 3: Initial (top) and final (bottom) state of liquid (left),
man judgments, it appears to over-fit the data in some cases.           sand (middle), and a set of rigid balls (right) for a testing trial
In the Static Condition, XGBoost’s predicted response pro-
                                                                        in Experiment 2 with 5 obstacles. The percentages indicate
portion for Pile 1 in the Trial 1 (1/2 cm funnel height) is
                                                                        the amount of each substance that fell into the left and right
greater than the proportion in Trial 2 (1 cm funnel height),
which is consistent with human judgments. In the Dynamic                basins. Only the initial state of each substance was shown in
Condition, however, XGBoost’s predicted response propor-                the testing trials.
tion for Pile 1 is greater in Trial 1 than in Trial 2, which is in-     The center points were generated by uniformly sampling the
consistent with trends in human performance. Alternatively,             entire space. If the generated obstacles were placed outside
GLM showed very poor performance, predicting an increas-                the boundary, the configuration was rejected and re-sampled.
ing probability of Pile 1 choices for larger funnel heights.            Our MPM simulator was used to determine the ground-truth
This trend is in the opposite direction of that observed in the         proportion of each substance in the left and right basins for
human data, most likely due to the small number of training             each of the generated situations. For each substance, forty
trials used to make each prediction.                                    testing trials (10 trials with 2, 3, 4, and 5 obstacles) were cho-
                                                                        sen from the generated set such that the ground-truth propor-
                        Experiment 2                                    tion of substance in the left basin was approximately uniform
Our results from the first experiment indicate that humans are          across trials. The testing trials were the same for each sub-
able to predict the resting geometry of sand piles, even though         stance.
they may not have very rich experience interacting with sand               Participants were randomly assigned to either the liquid,
in daily-life. The second experiment was conducted to deter-            sand, or rigid balls condition. Thirty participants were as-
mine 1) whether humans can reason about complex interac-                signed to each condition in a between-subjects experimental
tions between sand and rigid obstacles and 2) whether their             design. Prior to the testing trials, participants completed five
predictions about the resting state of sand in novel situations         practice trials with two obstacles in each situation in a ran-
differ from predictions about other substances, such as liquid          domized order. After answering 1) which basin the major-
and rigid balls.                                                        ity of the substance would fall into and 2) the expected pro-
Participants                                                            portion that would fall into the indicated basin, participants
                                                                        viewed a video (13 second duration) of the situation unfold-
A total of 90 undergraduate students (66 females), mean age
                                                                        ing and were told the resulting proportion in the ground-truth
20.9, were recruited from the UCLA Department of Psychol-
                                                                        simulation. After completing the practice trials, participants
ogy subject pool, and were compensated with course credit.
                                                                        completed 40 testing trials in a randomized order by answer-
Materials and Procedure                                                 ing the same two questions in each trial. No feedback was
The procedure in Experiment 2 was similar to the design in              given following the completion of each testing trial.
Bates et al.’s (2015) experiment: i.e., participants viewed a
                                                                        Human Results
volume of a substance suspended in the air above obstacles
and were asked to predict the proportion that would fall into           Participants’ predicted proportions in the testing trials were
two basins separated by a vertical divider below (Fig. 3). The          strongly correlated with ground-truth predictions in the liq-
present experiment differed from previous work in that par-             uid, sand, and rigid balls conditions (r(38)=0.86, 0.82, and
ticipants reasoned about the resting state of one of three dif-         0.88; RMSD = 0.145, 0.170, 0.186, respectively). The devi-
ferent substances: liquid, sand, or sets of rigid balls. Also,          ation for each trial was calculated by subtracting the ground-
whereas the previous study used polygonal obstacles, those in           truth proportion from each participant’s proportion response.
the present study were circles varying in size. Depth informa-          The deviation differed significantly between the three sub-
tion was also not present in the rendered situations. The stim-         stance conditions (F(2) = 3.64, p = 0.03), indicating that
ulus videos can be viewed at https://vimeo.com/216585992.               the difference between human predictions and the ground-
   Situations were generated by sampling between 2 and 5                truth status varied according to the substance type. To de-
obstacle locations from a uniform distribution bounded by the           termine whether participants’ response proportions differed
width and height of the chamber. The diameter, d, of each ob-           between substances, a random factor ANOVA was conducted
stacle was sampled from a uniform distribution bounded by               for a chosen set of trials. The chosen set excluded those trials
[0.15, 0.85] relative to the randomly-generated center points.          where the majority of each substance fell into the same basin
                                                                    703

                    1                               1                                1                                1
                   0.9
                                   fluid
                                   sand            0.9
                                                                    fluid
                                                                    sand            0.9
                                                                                                     fluid
                                                                                                     sand            0.9
                                                                                                                                     fluid
                                                                                                                                     sand
                                                                                                                                                           less consistent with human predictions (GLM: r(38) = 0.77,
                   0.8
                                   ball
                                                   0.8
                                                                    ball
                                                                                    0.8
                                                                                                     ball
                                                                                                                     0.8
                                                                                                                                     ball
                                                                                                                                                           0.78, 0.65, RMSD = 0.077, 0.120, 0.191; XGBoost: r(38) =
                                                                                                                                                           0.67, 0.74, 0.71, RMSD = 1.382, 1.422, 2.067 for liquid,
human prediction
                   0.7                             0.7                              0.7                              0.7
                   0.6                             0.6                              0.6                              0.6                                   sand and rigid balls, respectively). As in the previous exper-
                   0.5                             0.5                              0.5                              0.5                                   iment, we compared each model’s BIC measure in each con-
                   0.4                             0.4                              0.4                              0.4                                   dition to account for the number of free parameters in each
                   0.3                             0.3                              0.3                              0.3                                   model. We found that the BIC values for the ground-truth,
                   0.2                             0.2                              0.2                              0.2                                   GLM, and XGBoost models (GT: BIC = −154.5, −141.8,
                   0.1                             0.1                              0.1                              0.1                                   −134.6; GLM: BIC = −194.0, −158.6, −121.4; XGBoost:
                    0
                         0   0.2 0.4 0.6 0.8   1
                                                    0
                                                         0    0.2 0.4 0.6 0.8   1
                                                                                     0
                                                                                          0    0.2 0.4 0.6 0.8   1
                                                                                                                      0
                                                                                                                           0   0.2 0.4 0.6 0.8   1
                                                                                                                                                           BIC = 36.9, 39.2, 69.2 for liquid, sand, and rigid balls, re-
                             GT prediction                   ISE prediction                   GLM prediction XGBoost prediction                            spectively) were consistently greater than the values for the
      Figure 4: Model prediction results compared to human pre-                                                                                            ISE model (BIC = −190.0, −191.0, −171.6 for liquid, sand,
      dictions. From left to right: Ground-truth (GT), ISE, GLM,                                                                                           and rigid balls, respectively), further reinforcing the superior
      and XGBoost.                                                                                                                                         performance of our simulation-based model.
      (left or right) according to the ground-truth simulation. We                                                                                            It is worth noting that our ISE achieved consistent perfor-
      found that the response proportions showed significant differ-                                                                                       mance across all three substances, whereas GLM and XG-
      ences depending on substance type (F(2) = 8.43, p < 0.01).                                                                                           Boost were less capable of predicting human judgments about
      The next section examines whether an ISE and two data-                                                                                               rigid balls and liquid. In addition, our ISE used only one
      driven models can capture differences in human performance                                                                                           third of the training samples that XGBoost and GLM needed,
      between the three substances.                                                                                                                        demonstrating that a generative physical model with noisy
                                                                                                                                                           perceptual inputs is capable of learning with a smaller num-
      Model Results                                                                                                                                        ber of samples than data-driven methods.
      ISE Predictions: In Experiment 2, the observable input
      variables for our ISE for each substance were 1) the ini-
                                                                                                                                                                                   Discussion
      tial, horizontal position of the substance, and 2) the posi-                                                                                         Results from Experiments 1 and 2 provide converging evi-
      tions of the circular obstacles in each situation. The latent                                                                                        dence that humans can predict outcomes of novel physical
      substance attributes accepted by the engine were viscosity,                                                                                          situations by propagating approximate spatial representations
      friction angle, and restitution coefficient for liquid, sand, and                                                                                    forward in time using mental simulation. This stands in con-
      the rigid balls, respectively. Gaussian noise was added to the                                                                                       trast to early research in rigid-body collisions suggesting that
      substance’s (ground-truth) horizontal position (0 mean, 0.35                                                                                         human physical predictions do not obey ground-truth physics,
      variance) and the obstacles’ (ground-truth) positions in 2D                                                                                          instead relying on heuristics (e.g., Gilden & Proffitt, 1994;
      space (0 mean, 0.4 variance). Logarithmic Gaussian noise                                                                                             Runeson, Juslin, & Olsson, 2000). ISE predictions entailing
      was added to each substance’s ground-truth attribute value                                                                                           the noisy Newton framework outperformed both ground-truth
      via the logarithmic transformation specified in Experiment 1.                                                                                        and data-driven models in both experiments, further confirm-
      The results reported here utilized the following model param-                                                                                        ing the role of perceptual noise and physical dynamics in hu-
      eters for all three substances: σε = 0.5, ω = 0.8, k = 1.2. Two                                                                                      man intuitive physical predictions.
      thousand samples (40 situations × 50 noisy samples) were                                                                                                Previous work has demonstrated that humans sponta-
      used for each substance.                                                                                                                             neously employ mental simulation strategies when reason-
      Data-Driven Predictions: Similar to Experiment 1, both                                                                                               ing about novel physical situations (Clement, 1994; Hegarty,
      GLM and XGBoost were tested. The training data were ran-                                                                                             2004; Schwartz & Black, 1996). Recent fMRI results sug-
      domly generated situations with basin proportions calculated                                                                                         gest that intuitive physical inferences are made using an inter-
      using resting state output from our MPM simulator. Input                                                                                             nal physics engine encoded in the brain’s “multiple demand”
      features were the collection of both the observable input vari-                                                                                      network (Fischer, Mikhael, Tenenbaum, & Kanwisher, 2016).
      ables and latent substance attributes used in the ISE predic-                                                                                        Although our ISE employed herein accounted for percep-
      tion. In total, 6000 samples were used for training.                                                                                                 tual uncertainty in each situation, the simulations themselves
      Model Comparisons: Fig. 4 depicts the comparison be-                                                                                                 closely approximated normative physical principles. Adding
      tween human and model basin predictions from the ground-                                                                                             “stochastic noise” to physical dynamics, however, has been
      truth (GT), ISE, GLM, and XGBoost models, and Table                                                                                                  shown to increase model performance when predicting hu-
      1 depicts the root-mean-square deviation (RMSD) of each                                                                                              man responses in simple physical situations (K. A. Smith
      model’s predictions from human ones. The human data were                                                                                             & Vul, 2013). While dynamic uncertainty can easily be
      highly consistent with ISE predictions (r(38) = 0.93, 0.93,                                                                                          built into rigid-body collisions, employing this strategy in the
      0.93; RMSD = 0.081, 0.080, 0.102 for liquid, sand, and rigid                                                                                         present physical simulations would preclude stable numerical
      balls, respectively). The ISE model predictions deviated from                                                                                        evaluation. Thus, future computational work should explore
      the human data to a lesser degree than the GT model predic-                                                                                          methods for adding dynamic uncertainty into complex physi-
      tions (r(38) = 0.87, 0.85, 0.88; RMSD = 0.145, 0.170, 0.186                                                                                          cal simulations while preserving their accuracy and stability.
      for liquid, sand, and rigid balls, respectively), indicating a                                                                                          Results from the present study demonstrate that human
      superior account of human predictions across a range of sub-                                                                                         predictions about substance dynamics can be accurately pre-
      stances. In comparison, GLM and XGBoost predictions were                                                                                             dicted by a unified simulation method with uncertainty im-
                                                                                                                                                     704

plemented into underlying physical variables. It is unlikely,                  region (or yield surface) of the final material stress is restricted to be
however, that the human brain numerically evaluates partial                    inside                                tr(σ)
                                                                                                    tr(σ)cF + σ −              ≤ 0,                   (4)
differential equations to discern whether physical quantities                                                          d    F
(e.g., mass and momentum) are conserved, nor is it likely that                 where d is the dimension and cF is the coefficient of internal friction
the brain stores the locations of vast numbers of particles to                 between sand grains. The stress (and thus deformation gradient) of
form physical predictions and judgments. Instead, our results                  each sand particle is projected onto the yield surface so as to satisfy
provide evidence that humans approximate the dynamics of                       the second law of thermodynamics.
substances in a manner consistent with ground-truth physics
but succumb to biases invoked by perceptual noise when in-                                                 References
ferring future environmental states. It remains unclear, how-                  Batchelor, G. K. (2000). An introduction to fluid dynamics. Cam-
                                                                                  bridge university press.
ever, whether the dynamics of rigid objects, liquids, and gran-                Bates, C. J., Yildirim, I., Tenenbaum, J. B., & Battaglia, P. W.
ular materials are approximated using separable mechanisms                        (2015). Humans predict liquid dynamics using probabilistic sim-
or a single cognitive architecture with different assumptions                     ulation. In Proceedings of the 37th annual conference of the cog-
                                                                                  nitive science society.
and constraints. The success of our unified simulation model                   Battaglia, P. W., Hamrick, J. B., & Tenenbaum, J. B. (2013). Simu-
across different substance-types supports the latter perspec-                     lation as an engine of physical scene understanding. Proceedings
tive.                                                                             of the National Academy of Sciences, 110(45), 18327–18332.
                                                                               Chen, T., & Guestrin, C. (2016). Xgboost: A scalable tree boosting
Acknowledgments Support for the present study was                                 system. In Proceedings of the 22nd acm sigkdd international con-
provided by a NSF Graduate Research Fellowship, NSF                               ference on knowledge discovery and data mining (pp. 785–794).
grant BCS-1353391, DARPA XAI grant N66001-17-2-4029,                           Clement, J. (1994). Use of physical intuition and imagistic simula-
                                                                                  tion in expert problem solving.
DARPA SIMPLEX grant N66001-15-C-4035, ONR MURI                                 Fischer, J., Mikhael, J. G., Tenenbaum, J. B., & Kanwisher, N.
grant N00014-16-1-2007, and DoD CASIT grant W81XWH-                               (2016). Functional neuroanatomy of intuitive physical infer-
15-1-0147.                                                                        ence. Proceedings of the national academy of sciences, 113(34),
                                                                                  E5072-E5081.
                                                                               Gerstenberg, T., Goodman, N. D., Lagnado, D. A., & Tenenbaum,
    Appendix: Details of Our MPM Simulator                                        J. B. (2015). How, whether, why: Causal judgments as counter-
The governing partial differential equations utilize the principles of            factual contrasts. In Proceedings of the 37th annual conference of
conservation of mass and momentum:                                                the cognitive science society.
                                                                               Gilden, D. L., & Proffitt, D. R. (1994). Heuristic judgment of mass
                 Dρ                     Dv                                        ratio in two-body collisions. Perception & Psychophysics, 56(6),
                      + ρ∇ · v = 0,         = ∇ · σ + ρg,              (1)
                  Dt                    Dt                                        708–720.
where σ is the stress imparted on a particle, g is the gravitational ac-       Hamrick, J. B., Battaglia, P. W., Griffiths, T. L., & Tenenbaum, J. B.
                  D                                                               (2016). Inferring mass in complex scenes by mental simulation.
celeration, and Dt   is the material derivative with respect to time. The         Cognition, 157, 61–76.
equations are discretized spatially and temporally with a collection           Hegarty, M. (2004). Mechanical reasoning by mental simulation.
of Lagrangian particles (or material points) and a background Eule-               Trends in cognitive sciences, 8(6), 280–285.
rian grid. The material type of the simulated substances is naturally          Jiang, C., Schroeder, C., Selle, A., Teran, J., & Stomakhin, A.
specified from the constitutive model, which defines how a material               (2015). The affine particle-in-cell method. ACM Transactions
exerts internal stress (or forces) as a result of deformation.                    on Graphics (TOG), 34(4), 51.
   Rigid balls are simulated as highly stiff elastic objects with the          Jiang, C., Schroeder, C., Teran, J., Stomakhin, A., & Selle, A.
neo-Hookean hyperelasticity model, described through the elastic                  (2016). The material point method for simulating continuum ma-
energy density function                                                           terials. In Acm siggraph 2016 course (pp. 24:1–24:52).
                                                                               Klár, G., Gast, T., Pradhana, A., Fu, C., Schroeder, C., Jiang, C., &
                     µ                               λ                            Teran, J. (2016). Drucker-prager elastoplasticity for sand anima-
           Ψ(F) = (tr(FT F) − d) − µ log(J) + log2 (J),                (2)        tion. ACM Trans Graph, 35(4), 103:1–103:12.
                     2                               2
                                                                               Kubricht, J. R., Jian, C., Zhu, Y., Zhu, S. C., Terzopoulos, D., &
where d is the dimension (2 or 3), F is the deformation gradient (i.e.,           Lu, H. (2016). Probabilistic simulation predicts human perfor-
the gradient of the deformation from undeformed space to deformed                 mance on viscous fluid-pouring problem. In Proceedings of the
space), J is the determinant of F, and µ and λ are Lamé parameters               38th annual conference of the cognitive science society.
that describe the material’s stiffness.                                        McCullagh, P. (1984). Generalized linear models. European Journal
   Liquid is modeled as a nearly incompressible fluid, with its state             of Operational Research, 16(3), 285–292.
governed by the Tait equation (Batchelor, 2000):                               Monaghan, J. J. (1992). Smoothed particle hydrodynamics. Annual
                                 γ
                                     ρ0
                                                                                 review of astronomy and astrophysics, 30, 543–574.
                           p=k             −1 ,                        (3)     Runeson, S., Juslin, P., & Olsson, H. (2000). Visual perception of
                                     ρ                                            dynamic properties: cue heuristics versus direct-perceptual com-
where p is the pressure, ρ and ρ0 are the current and original densi-             petence. Psychological Review, 107(3), 525–555.
ties of the particles, γ = 7 for water, and k is the bulk modulus (i.e.,       Sanborn, A. N. (2014). Testing bayesian and heuristic predictions
how incompressible the fluid is). Through this Equation-of-State                  of mass judgments of colliding objects. Frontiers in psychology,
                                                                                  5.
(EOS), the stress inside a non-viscous fluid is given by σ = −pI,              Sanborn, A. N., Mansinghka, V. K., & Griffiths, T. L. (2013). Rec-
where I is the identity matrix. We further adopt the Affine Particle-             onciling intuitive physics and newtonian mechanics for colliding
In-Cell method (APIC) (Jiang et al., 2015) to greatly reduce numer-               objects. Psychological review, 120(2), 411.
ical error and artificial damping. This enables us to simulate flu-            Schwartz, D. L., & Black, J. B. (1996). Analog imagery in mental
ids with better accuracy compared to alternative computer graphics                model reasoning: Depictive models. Cognitive Psychology, 30(2),
methods.                                                                          154–219.
   The motion of dry sand is largely determined by the frictional              Smith, K., Battaglia, P., & Vul, E. (2013). Consistent physics un-
contact between grains. In the theory of elastoplasticity, the mod-               derlying ballistic motion prediction. In Proceedings of the 35th
eling of large deformation (e.g., frictional contact) can be based on             conference of the cognitive science society (pp. 3426–3431).
a constitutive law that follows the Mohr-Coulomb friction theory.              Smith, K. A., & Vul, E. (2013). Sources of uncertainty in intuitive
Following (Klár et al., 2016), we simulate dry sand based on the                 physics. Topics in cognitive science, 5(1), 185–199.
Saint Venant Kirchhoff (StVK) elasticity model combined with a                 Sulsky, D., Zhou, S., & Schreyer, H. (1995). Application of a
Drucker-Prager non-associated flow rule. Plasticity models the ma-                particle-in-cell method to solid mechanics. Comp Phys Comm,
terial response as a constraint projection problem, where the feasible            87(1), 236–252.
                                                                           705

